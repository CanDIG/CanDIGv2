# tested on docker-engine 18.06.0
version: '3.7'

networks:
  bridge-net:
    external: true
  traefik-net:
    external: true
  agent-net:
    external: true

volumes:
  minio-data:
    external: true
  minio-config:
    external: true
  mc-config:
    external: true
  toil-jobstore:
    external: true
  portainer-data:
    external: true

secrets:
  minio_access_key:
    file: $PWD/minio_access_key
  minio_secret_key:
    file: $PWD/minio_secret_key
  portainer_user:
    file: $PWD/portainer_user
  portainer_secret:
    file: $PWD/portainer_secret
  traefik_ssl_key:
    file: $PWD/etc/ssl/${TRAEFIK_SSL_CERT:-selfsigned-site}.key
  traefik_ssl_crt:
    file: $PWD/etc/ssl/${TRAEFIK_SSL_CERT:-selfsigned-site}.crt
  wes_dependency_resolver:
    file: $PWD/etc/yml/$WES_DEPENDENCY_RESOLVER

x-deploy:
  &default-restart
  restart_policy:
    delay: 10s
    max_attempts: 10
    window: 60s
  labels:
    - traefik.enable=true
    - traefik.docker.network=${TRAEFIK_NET:-traefik-net}
